# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

# Архитектура приложения


## Паттерн проектирования
В данной проеткной работе используется паттерн MVP (Model-View-Presenter), который разделяет приложения на 3 основных компонента:
1. Модель. Она служит для представления данных и бизнес-логики приложения. Ее основная задача заключается в выполнении операций, таких как чтение и запись данных, обработка бизнес-логики, а также взаимодействие с базой данных или внешними источниками информации.
2. Представление (View). Оно демонстрирует данные пользователю и обрабатывает его ввод. Представление служит пользовательским интерфейсом, посредством которого осуществляется взаимодействие пользователя с приложением.
3. Презентер (Presenter). Является посредником между моделью и представлением. Он содержит бизнес-логику приложения и управляет взаимодействием между моделью и представлением. Презентер получает данные от модели, форматирует их и передаёт представлению для отображения. Он также обрабатывает пользовательский ввод, передавая соответствующие команды модели для обновления данных.

## Интерфейсы для данных

**Интерфейс представления главной страницы**
interface IMain {
  counter: number;
  catalog: HTMLElement[];
  locked: boolean;
}

**определяем тип для категории товара**
type ProductCategory = 'софт-скил' | 'другое' | 'дополнительное' | 'кнопка' | 'хард-скил';

**Интерфейс для карточки товара**
interface IProduct {
  id: string;  //  идентификатор товара
  image: string;  // изображение товара
  title: string;  // наименование товара
  category: ProductCategory;  // категория продукта
  price: number | null;  // цена товара
  description: string;  // описание товара
}

**Интерфейс для списка товаров на главной страницы**
interface IProductList {
  productList: IProduct[];  // массив товаров
}

**Интерфейс для корзины**
interface IOrderBasket {
  basketItems: IProduct[]; // массив товаров в корзине
  totalPrice: number; // общая сумма заказа в корзине
}

**Интерфейс для заказа**
interface IOrderForm {
  basket: IOrderBasket;  // выбранные товары(массив товаров)
  paymentMethod: string;  // метод оплаты
  address: string;  // адрес доставки
  email: string;  // почта пользователя
  phone: string;  // телефон пользователя
}

## Описание базовых классов

**Класс Api** предназначен для упрощения работы с HTTP-запросами к серверу. Он предоставляет методы для выполнения GET- и POST-запросов (включая PUT и DELETE) и обработки ответов от сервера. Класс инкапсулирует базовый URL сервера и настройки запросов, что делает взаимодействие с API более удобным

handleResponse() - обрабатывает ответ от сервера
get() - выполняет GET-запрос к серверу
post() - Выполняет POST-, PUT- или DELETE-запрос к серверу

**Класс Component<T>** - базовый класс для создания компонентов пользовательского интерфейса. Он предоставляет инструменты для работы с DOM-элементами, такие как управление классами, текстовым содержимым, видимостью, блокировкой и изображениями. Класс абстрактный, поэтому используется только через наследование

 toggleClass() - переключает класс у указанного DOM-элемента
 setText() - устанавливает текстовое содержимое указанного DOM-элемента
 setImage() - устанавливает изображение и альтернативный текст для указанного элемента <img>
 render() - возвращает состояние компонента и возвращает корневой DOM-элемент

**Класс EventEmitter** предназначен для взаимодействия с событиями

 on() - подписывает обработчик на указанное событие
 off() - отписывает обработчик от указанного события
 emit() - инициирует событие с данными
 onAll() - подписывает обработчик на все события
 offAll() - Сбрасывает все обработчики события
 trigger() - создает триггер, который при вызове инициирует указанное событие.

**Класс Abstract** предназначен для того, чтобы можно было отличить ее от простых объектов с данными
emitChanges() - сообщает всем что модель поменялась


## Слой модель

**Класс ApiModel** отвечает за взаимодействие с сервером. Он наследуется от класса Api и предоставляет методы для получения данных о товарах и отправки данных на сервер
class ApiModel
  **поля:**
  baseUrl: string - базовый URL API, к которому будут отправляться запросы
  **методы:**
  constructor(baseUrl: string) - конструктор для инициализации базового URL API
  getList() - возвращает массив данных карточек с помощью get-запроса
  post() - отправляет данные на сервер

**Класс ProductModel** отвечает за хранение и управление данными о товарах. Он предоставляет список товаров, которые пользователь может просматривать и добавлять в корзину
class ProductModel
  **поля:**
  productList: IProduct[] - конструктор для инициализации массива товаров, загруженных с сервера
  **методы:**
  constructor(products: IProduct[]) - принимает массив товаров, загруженных с сервера
  getProduct() - возвращает список товаров, которые не добавлены в корзину

**Класс BasketModel** отвечает за хранение данных о корзине. Он управляет товарами, которые пользователь добавил в корзину, и рассчитывает общую сумму заказа
class BasketModel
  **поля:**
  basket: OrderBasket — объект, хранящий товары в корзине
  totalPrice: number - общая сумма заказа
  **методы:**
  constructor() - конструктор для инициализации объекта корзины и общей стоимости заказа
  addProduct() - добавляет товар в корзину
  removeProduct() - удаляет товар из корзины
  getBasket() - возвращает текущее состояние корзины
  sumOrder() - подсчитывает и выводит общую сумму заказа в корзине
  getTotalPrice() - возвращает общую сумму заказа
  clearBasket() - очищает корзину (удаляет все товары и сбрасывает сумму заказа)

**Класс OrderModel** отвечает за хранение данных, которые пользователь вводит при оформлении заказа. Он управляет способом оплаты, адресом доставки и контактными данными
class OrderModel
  **поля:**
  order: OrderForm — объект, хранящий данные о заказе
  **методы:**
  constructor() - Конструктор для инициализации объекта заказа с данными о способе оплаты и контактной информации
  setPaymentMethod(method: string) - устанавливает способ оплаты
  setAddress(address: string) - устанавливает адрес доставки
  setContacts(email: string, phone: string) - устанавливает контактные данные пользователя
  resetOrder() - сбрасывает введенные данные(адреса)
  resetContact() - сбрасывает введенные данные(почту и телефон)
  completeOrder() - отмечает заказ как успешно оформленный
  validateOrder() - валидация полей формы адреса
  validateContact() - валидация полей формы контактов(почты и телефона)

## Слой представления

**Класс ModalView** Базовый класс для всех модальных окон. Отвечает за общую функциональность для открытия и закрытия модальных окон.
class ModalView
  **поля:**
  modalElement: HTMLElement - элемент, представляющий модальное окно
  content: HTMLElement - содержимое модального окна
  closeButton: HTMLButtonElement - кнопка закрытия модального окна
  **методы:**
  constructor() - инициализирует модальное окно (контейнер, содержимое и кнопку закрытия)
  open() - открывает модальное окно
  close() - закрывает модальное окно
  closeEsc() - закрывает модальное окно через клавишу Escape
  renderModal() - отображает переданный контент в модальном окне

**Класс MainPageView** отображает главную страницу с карточками товаров и иконкой корзины
class MainPageView
  **поля:**
  counter: HTMLElement - счетчик товаров, который находится на иконке корзины
  catalog: HTMLElement - контейнер для массива карточек
  wrapper: HTMLElement - контейнер для всей страницы
  basket: HTMLElement - иконка корзины на главной странице
  **методы:**
  constructor() - инициализирует главную страницу (счетчик товаров, каталог и корзину)
  set counter() - cеттер для обновления счетчика товаров в корзине
  set catalog() - cеттер для обновления списка товаров в каталоге
  set locked() - cеттер для блокировки или разблокировки прокрутки страницы

**Класс ProductContainer** отображает массив карточек товаров
  **поля:**
  catalog: HTMLElement[] - массив темплейтов карточек
  container: HTMLElement - корневой элемент DOM, в котором отрисовывется массив темплейтов карточек
  **методы:**
  constructor() -  инициализирует контейнер для отображения массива карточек товаров
  set catalog() - устанавливает массив карточек
  render() - возвращает заполненный массив с карточками

**Класс ProductView** отображает карточку товара на главной странице
  **поля:**
  category: HTMLElement[] - массив категорий, которые можно установить на товар
  title: HTMLElement - элемент, отображающий название товара
  image: HTMLElement - элемент, отображающий изображение товара
  price: HTMLElement - элемент, отображающий цену товара
  button: HTMLButtonElement - кнопка(полностью карточка на главной странице)
  **методы:**
  constructor() - инициализирует карточку товара (название, изображение, цену и кнопку)
  set id(value: string) - устанавливает идентификатор карточки
  get id(): string - возвращает идентификатор карточки
  set category() - устанавливает категорию товара
  set title() - устанавливает заголовок карточки
  get title() - возвращает заголовок карточки
  set image() - устанавливает изображение карточки
  set price() - устанавливает цену товара

**Класс ProductDetailsView** отображает подробную информацию о товаре в модальном окне
  **поля:**
  description: HTMLElement - элемент, отображающий описание товара
  addToBasketButton: HTMLButtonElement — кнопка, которая перемещает товар в корзину
  **методы:**
  constructor() - инициализирует детали товара (описание и кнопку добавления в корзину)
  set description() - устанавливает описание товара
  disabledButton() - деактивирует кнопку, если товар бесценен(равен null)

**Класс BasketView** отображает корзину с товарами в модальном окне
  **поля:**
  basketItemIndex: HTMLElement - элемент, отображающий номер товара по порядку
  basketProducts: Iproduct[] - массив списка товаров, добавленных в корзину
  basketItemDelete: HTMLButtonElement - кнопка удаления товара из корзины
  totalPrice: number: общая стоимость всех товаров в корзине
  checkoutButton: HTMLButtonElement — кнопка "Оформить заказ"
  **методы:**
  constructor() - инициализирует корзину (массив товаров и общую сумму)
  set basketIndex() - устанавливает номер товара
  set listProducts() - устанавливает список товаров в корзине
  set price() - устанавливает общую сумму заказа
  disabledButton() - деактивирует кнопку "Оформить заказ"

**Класс PaymentView** отображает форму выбора способа оплаты и ввода адреса доставки
  **поля:**
  paymentMethodCard: HTMLElement - способ оплаты онлайн
  paymentMethodCash: HTMLElement - способ оплаты при получении
  container: HTMLFormElement - корневой элемент формы ввода адреса
  nextButton: HTMLButtonElement — кнопка "Далее"
  **методы:**
  constructor() -  инициализирует форму оплаты (способ оплаты и адрес доставки)
  getSelectedPaymentMethod() - получение выбранного способа оплаты
  set address() - устанавливает адрес
  disabledButton() - деактивирует кнопку, если пользователь не ввел корректно данные

**Класс ContactsView** отображает форму ввода контактных данных (email и телефон) пользователя
  **поля:**
  container: HTMLFormElement - корневой элемент формы ввода контактных данных
  submitButton: HTMLButtonElement — кнопка "Оплатить"
  **методы:**
  constructor() - инициализирует форму контактов (email и телефон)
  set email(value: string) - cеттер для обновления значения поля email в форме 
  set phone(value: string) - cеттер для обновления значения поля телефона в форме

**Класс SuccessView** отображает сообщение об успешном оформлении заказа
  **поля:**
  successMessage: HTMLElement — элемент, отображающий сообщение об успешном оформлении
  total: HTMLElement - сумма заказа
  continueButton: HTMLButtonElement — кнопка "За новыми покупками"
  **методы:**
  constructor() - инициализирует сообщение об успешном заказе (сумма заказа и кнопка продолжения)
  set totalSum() - сеттер для записи суммы заказа

## Слой презентера
**Используется событийно-ориентированный подход. Каждое действие пользователя инициирует событие, которое обрабатывается презентером. Презентер взаимодействует с моделью для обновления данных и с представлением для отображения изменений. Этот класс не будет вынесен в отдельный файл, а останется в основном скрипте приложения**

**Класс MainPagePresenter** отвечает за взаимодействие с главной страницей (отображение товаров, обновление корзины и т.д.)
class MainPagePresenter
  **поля:**
  productModel: ProductModel - модель товаров
  basketModel: BasketModel - модель корзины
  mainPageView: MainPageView - представление главной страницы
  eventEmitter: EventEmitter - обработчик событий
  **методы:**
  constructor() - инициализирует презентер (подписывается на события и загружает данные)
  initialize() - загружает товары и обновляет каталог
  setupEventListeners() - настраивает обработчики событий
  handleAddToBasket(productId: string) - добавляет товар в корзину
  updateBasketCounter() - обновляет счетчик товаров в корзине
  handleOpenBasket() - открывает корзину

**Класс BasketPresenter** отвечает за взаимодействие с корзиной (добавление, удаление товаров, оформление заказа)
class BasketPresenter
  **поля:**
  basketModel: BasketModel - модель корзины
  basketView: BasketView - представление корзины
  eventEmitter: EventEmitter - обработчик событий
  **методы:**
  constructor() - инициализирует презентер (подписывается на события и загружает данные)
  initialize() - загружает товары в корзину и обновляет отображение
  setupEventListeners() - настраивает обработчики событий
  handleRemoveFromBasket(productId: string) - удаляет товар из корзины
  handleOrderSubmit() - обрабатывает оформление заказа

**Класс OrderPresenter** отвечает за взаимодействие с формой заказа (оплата, адрес, контакты)
class OrderPresenter
  **поля:**
  orderModel: OrderModel - модель заказа
  paymentView: PaymentView - представление формы оплаты
  contactsView: ContactsView - представление формы контактов
  eventEmitter: EventEmitter - обработчик событий
  **методы:**
  constructor() - инициализирует презентер (подписывается на события)
  setupEventListeners() - настраивает обработчики событий
  handleOpenOrder() - открывает форму заказа
  handleOrderSubmit() - обрабатывает отправку формы заказа
  handleContactsSubmit() - обрабатывает отправку контактных данных

**Класс SuccessPresenter** отвечает за отображение сообщения об успешном оформлении заказа
class SuccessPresenter
  **поля:**
  successView: SuccessView - представление успешного заказа
  orderModel: OrderModel - модель заказа
  eventEmitter: EventEmitter - обработчик событий

  **методы:**
  constructor() - инициализирует презентер (подписывается на события)
  setupEventListeners() - настраивает обработчики событий
  handleOrderComplete() - отображает сообщение об успешном заказе

## Взаимодействие компонентов
items:changed - изменение товара
product:select - выбор товара
product:addToBasket - добавление товара в корзину
basket:open - открытие корзины
basket:add - добавление товара
basket:remove — удаление товара
basket:change — изменение корзины
order:open — возникает, когда открывается форма с выбором оплаты
order:submit - возникает, когда пользователь оформляет заказ
order:reset - исброс полей формы адреса
contacts:submit — возникает, когда пользователь отправляет форму
contacts:reset — сброс полей формы контактов(почта и телефон)
modal:open - возникает, когда пользователь открывает модальное окно
modal:close - возникает, когда пользователь закрывает модальное окно
